<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Qu·∫£n l√Ω - ƒêi·ªán M√°y Xanh Savico</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --dmx-blue: #0088ff;
            --dmx-green: #28a745;
            --dmx-orange: #fd7e14;
            --bg-color: #f0f2f5;
            --border-color: #dee2e6;
            --text-dark: #333;
            --text-light: #fff;
            --danger-color: #dc3545;
        }

        /* --- C√†i ƒë·∫∑t t·ªïng th·ªÉ --- */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            display: flex;
            flex-direction: column;
        }

        /* --- Header c·ªßa trang ch·ªß --- */
        .main-header {
            background: linear-gradient(90deg, var(--dmx-blue) 0%, var(--dmx-green) 100%);
            color: var(--text-light);
            padding: 10px 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            position: relative;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .main-header .store-icon {
            width: 40px;
            height: 40px;
            fill: var(--text-light);
        }

        .main-header h1 {
            margin: 0;
            font-size: 1.6em;
            font-weight: 600;
        }

        /* --- N√∫t Backup T·ªïng --- */
        .backup-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            margin-right: 15px;
        }
        .backup-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        /* --- CSS CHO PH·∫¶N M√É QR (ƒê√£ kh√¥i ph·ª•c) --- */
        .qr-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.15);
            padding: 5px 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            cursor: pointer;
            transition: background-color 0.3s ease;
            position: relative;
            z-index: 101;
            min-width: 180px; /* ƒê·∫£m b·∫£o ƒë·ªß r·ªông cho d√≤ng text */
        }

        .qr-img {
            width: 60px; /* Kh√¥i ph·ª•c k√≠ch th∆∞·ªõc c≈© */
            height: 60px;
            object-fit: contain;
            border-radius: 4px;
            background-color: #fff;
            display: block;
        }

        .qr-text {
            font-size: 11px; /* Kh√¥i ph·ª•c font c≈© */
            margin-top: 4px;
            font-weight: 500;
            color: #fff;
            text-transform: none; /* B·ªè in hoa to√†n b·ªô */
            letter-spacing: 0.5px;
            text-align: center;
        }

        /* Overlay QR */
        .qr-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }

        .qr-overlay.active {
            display: flex;
            opacity: 1;
        }

        .qr-overlay-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            animation: fadeInScale 0.3s ease-out forwards;
            position: relative;
        }

        .qr-overlay-img {
            width: 250px;
            height: 250px;
            object-fit: contain;
            display: block;
            margin: 0 auto 15px auto;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        
        /* N√∫t ƒë√≥ng overlay */
        .qr-overlay-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 2em;
            color: #555;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .qr-overlay-close:hover {
            color: #000;
        }

        /* --- Backup Modal Styles --- */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.5); 
            backdrop-filter: blur(2px);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; 
            padding: 25px;
            border: 1px solid #888;
            width: 90%; 
            max-width: 700px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .close-modal {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-modal:hover { color: #000; }

        .backup-textarea {
            width: 100%;
            height: 200px;
            margin: 15px 0;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            resize: vertical;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-copy { background-color: #6c757d; color: white; }
        .btn-restore { background-color: var(--dmx-green); color: white; }
        .btn-clear { background-color: var(--danger-color); color: white; margin-right: auto; }
        
        .action-btn:hover { opacity: 0.9; transform: translateY(-1px); }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* --- Thanh Tabs ƒëi·ªÅu h∆∞·ªõng (ƒê√É C·∫¨P NH·∫¨T GIAO DI·ªÜN M·ªöI) --- */
        .tab-bar {
            background-color: var(--bg-color); 
            padding: 15px 20px; 
            border-bottom: none; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            display: flex;
            gap: 15px; 
            flex-wrap: wrap;
            z-index: 99;
            position: sticky; /* Gi·ªØ thanh tab c·ªë ƒë·ªãnh khi cu·ªôn */
            top: 0;
        }

        .tab-button {
            padding: 10px 22px; 
            cursor: pointer;
            border: none;
            background-color: #fff; 
            font-size: 0.95em;
            font-weight: 600;
            color: #555;
            border-radius: 25px; /* H√¨nh vi√™n thu·ªëc hi·ªán ƒë·∫°i */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); /* Transition m∆∞·ª£t m√† h∆°n */
            display: flex;
            align-items: center;
            gap: 8px;
            /* Hi·ªáu ·ª©ng N·ªïi kh·ªëi 3D (Neumorphism nh·∫π) */
            box-shadow: 
                3px 3px 6px rgba(189, 194, 201, 0.7), /* Shadow t·ªëi/d∆∞·ªõi */
                -3px -3px 6px rgba(255, 255, 255, 1); /* Shadow s√°ng/tr√™n */
        }

        .tab-button:hover { 
            color: var(--dmx-blue); 
            /* Hi·ªáu ·ª©ng N·ªïi kh·ªëi khi hover: Nh·∫•c nh·∫π l√™n */
            transform: translateY(-2px); 
            box-shadow: 
                5px 5px 10px rgba(189, 194, 201, 0.8), 
                -5px -5px 10px rgba(255, 255, 255, 1.2);
        }

        .tab-button.active { 
            color: var(--text-light); 
            /* Hi·ªáu ·ª©ng B·ªã Nh·∫•n (Pressed) v·ªõi Gradient v√† Shadow nh·∫•n v√†o trong */
            background: linear-gradient(45deg, var(--dmx-blue), #0066cc);
            transform: translateY(0); 
            box-shadow: 
                inset 2px 2px 5px rgba(0, 0, 0, 0.2), 
                inset -2px -2px 5px rgba(255, 255, 255, 0.1),
                0 1px 3px rgba(0, 0, 0, 0.2); 
        }

        /* --- V√πng ch·ª©a n·ªôi dung --- */
        .content-area {
            flex-grow: 1;
            overflow: hidden;
            position: relative;
            z-index: 1;
            background: #fff;
        }

        .tab-content {
            display: none;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .tab-content.active { display: block; }
        .content-iframe { width: 100%; height: 100%; border: none; }
        
        /* Toast Notification */
        .toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 16px;
            position: fixed;
            z-index: 3000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 16px;
        }
        .toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        @media (max-width: 900px) {
            .main-header { flex-direction: column; align-items: stretch; gap: 10px; padding: 10px;}
            .header-left { justify-content: space-between; }
            .header-actions { flex-direction: column; align-items: stretch; }
            .backup-btn { margin-right: 0; justify-content: center; }
            /* C·∫≠p nh·∫≠t responsive cho thanh tab m·ªõi */
            .tab-bar { padding: 10px; overflow-x: auto; flex-wrap: nowrap; }
            .tab-button { padding: 8px 15px; white-space: nowrap; font-size: 0.9em; }
        }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-left">
            <svg class="store-icon" viewBox="0 0 24 24">
                <path d="M12,3L2,12V21H22V12L12,3M19,19H17V12H7V19H5V10.19L12,5.69L19,10.19V19M12,14A2,2 0 0,1 14,16A2,2 0 0,1 12,18A2,2 0 0,1 10,16A2,2 0 0,1 12,14Z" />
            </svg>
            <h1>üèÜDashboard Qu·∫£n l√Ω - NH.D∆∞∆°ng 32859üèÜ</h1>
        </div>
        
        <div class="header-actions" style="display: flex; align-items: center; gap: 5px;">
            <button class="backup-btn" onclick="openBackupModal()">
                <i class="fas fa-database"></i> Backup/Restore T·ªïng
            </button>

            <div class="qr-container" id="qrContainer">
                <img src="qr.png" alt="QR VietinBank" class="qr-img">
                <span class="qr-text">üíóTh·∫•y hay th√¨ m·ªùi D∆∞∆°ng c·ªëc C√† Ph√™!‚òï</span>
            </div>
        </div>
    </header>

    <div class="tab-bar">
        <button class="tab-button active" onclick="openTab(event, 'Rtst')">üìä Realtime</button>
        <button class="tab-button" onclick="openTab(event, 'Lkst')">üßë‚Äçüíª BI L≈©y K·∫ø</button>
        <button class="tab-button" onclick="openTab(event, 'biNhanVien')">üßë‚Äçüíª BI Nh√¢n vi√™n</button>
        <button class="tab-button" onclick="openTab(event, 'baoCaoYCX')">üìà B√°o c√°o YCX</button>
        <button class="tab-button" onclick="openTab(event, 'tonlap')">üì¶ T·ªìn Laptop</button>
        <button class="tab-button" onclick="openTab(event, 'popuploc')">üñ®Ô∏è In popup</button>    
        <button class="tab-button" onclick="openTab(event, 'banhang')">‚úçÔ∏è Nh·∫≠t k√Ω BH</button>  
    </div>

    <main class="content-area">
        <div id="Rtst" class="tab-content active">
            <iframe id="iframe-rt" class="content-iframe" src="./RT.html"></iframe>
        </div>
        <div id="Lkst" class="tab-content">
            <iframe id="iframe-lk" class="content-iframe" src="./Lkst.html"></iframe>
        </div>
        <div id="biNhanVien" class="tab-content">
            <iframe id="iframe-nv" class="content-iframe" src="./NV.html"></iframe>
        </div>
        <div id="baoCaoYCX" class="tab-content">
            <iframe class="content-iframe" src="./YCX.html"></iframe>
        </div>
        <div id="tonlap" class="tab-content">
            <iframe class="content-iframe" src="./tonlap.html"></iframe>
        </div>
        <div id="popuploc" class="tab-content">
            <iframe class="content-iframe" src="./popuploc.html"></iframe>
        </div>    
        <div id="banhang" class="tab-content">
            <iframe class="content-iframe" src="./banhang.html"></iframe>
        </div>  
    </main>

    <div class="qr-overlay" id="qrOverlay">
        <div class="qr-overlay-content">
            <span class="qr-overlay-close" onclick="hideQrOverlay()">&times;</span>
            <img src="qr.png" alt="QR VietinBank" class="qr-overlay-img">
            <span class="qr-overlay-text">üíóTh·∫•y hay th√¨ m·ªùi D∆∞∆°ng c·ªëc C√† Ph√™!‚òï</span>
        </div>
    </div>

    <div id="backupModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeBackupModal()">&times;</span>
            <h2 style="margin-top:0; color: var(--dmx-blue);"><i class="fas fa-database"></i> Qu·∫£n l√Ω D·ªØ li·ªáu H·ªá th·ªëng</h2>
            <p style="font-size: 0.9em; color: #666;">
                D∆∞·ªõi ƒë√¢y l√† m√£ d·ªØ li·ªáu bao g·ªìm <strong>TO√ÄN B·ªò</strong> th√¥ng tin t·ª´ t·∫•t c·∫£ c√°c trang (Realtime, L≈©y k·∫ø, Nh√¢n vi√™n...).<br>
                - ƒê·ªÉ <strong>Backup</strong>: Sao ch√©p m√£ n√†y v√† l∆∞u l·∫°i.<br>
                - ƒê·ªÉ <strong>Restore</strong>: D√°n m√£ v√†o ƒë√¢y v√† ·∫•n n√∫t "Kh√¥i ph·ª•c".
            </p>
            
            <textarea id="globalDataTextarea" class="backup-textarea" placeholder="Chu·ªói d·ªØ li·ªáu backup s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>
            
            <div class="modal-actions">
                <button class="action-btn btn-clear" onclick="clearAllData()">üóëÔ∏è X√≥a s·∫°ch d·ªØ li·ªáu</button>
                <button class="action-btn btn-copy" onclick="copyGlobalData()">üìã Sao ch√©p</button>
                <button class="action-btn btn-restore" onclick="restoreGlobalData()">üì• Kh√¥i ph·ª•c & T·∫£i l·∫°i</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast">Th√¥ng b√°o</div>

    <script>
        // --- Tab Logic ---
        function openTab(evt, tabName) {
            let i, tabContents, tabButtons;
            tabContents = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            tabButtons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // --- QR Logic (ƒê√£ kh√¥i ph·ª•c: Hover/Di chu·ªôt) ---
        const qrContainer = document.getElementById('qrContainer');
        const qrOverlay = document.getElementById('qrOverlay');

        // S·ª≠ d·ª•ng mouseenter (hover) thay v√¨ click
        qrContainer.addEventListener('mouseenter', () => {
            qrOverlay.classList.add('active');
            // document.body.style.overflow = 'hidden'; // T√πy ch·ªçn: ch·∫∑n cu·ªôn khi hi·ªán overlay
        });

        function hideQrOverlay() {
            qrOverlay.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Th√™m n√∫t ƒë√≥ng v√† click ra ngo√†i ƒë·ªÉ ƒë√≥ng
        qrOverlay.addEventListener('click', (event) => {
            if (event.target === qrOverlay) hideQrOverlay();
        });

        // --- BACKUP / RESTORE GLOBAL LOGIC ---
        function openBackupModal() {
            const modal = document.getElementById('backupModal');
            const textarea = document.getElementById('globalDataTextarea');
            
            // L·∫•y to√†n b·ªô d·ªØ li·ªáu t·ª´ localStorage
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                allData[key] = localStorage.getItem(key);
            }
            
            // Chuy·ªÉn th√†nh chu·ªói JSON ƒë·∫πp
            textarea.value = JSON.stringify(allData, null, 2);
            modal.style.display = "block";
        }

        function closeBackupModal() {
            document.getElementById('backupModal').style.display = "none";
        }

        function copyGlobalData() {
            const textarea = document.getElementById('globalDataTextarea');
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            document.execCommand('copy');
            showToast("ƒê√£ sao ch√©p to√†n b·ªô d·ªØ li·ªáu v√†o b·ªô nh·ªõ ƒë·ªám!");
        }

        function restoreGlobalData() {
            const textarea = document.getElementById('globalDataTextarea');
            const jsonStr = textarea.value.trim();
            
            if (!jsonStr) {
                showToast("Vui l√≤ng d√°n m√£ d·ªØ li·ªáu v√†o √¥ tr·ªëng.");
                return;
            }

            try {
                const data = JSON.parse(jsonStr);
                
                if (typeof data !== 'object' || data === null) {
                    throw new Error("D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá.");
                }

                if (confirm("C·∫£nh b√°o: H√†nh ƒë·ªông n√†y s·∫Ω GHI ƒê√à to√†n b·ªô d·ªØ li·ªáu hi·ªán t·∫°i c·ªßa t·∫•t c·∫£ c√°c trang b·∫±ng d·ªØ li·ªáu m·ªõi. B·∫°n c√≥ ch·∫Øc ch·∫Øn kh√¥ng?")) {
                    // X√≥a d·ªØ li·ªáu c≈©
                    localStorage.clear();
                    
                    // N·∫°p d·ªØ li·ªáu m·ªõi
                    for (const key in data) {
                        localStorage.setItem(key, data[key]);
                    }

                    showToast("Kh√¥i ph·ª•c th√†nh c√¥ng! Trang s·∫Ω t·∫£i l·∫°i sau 2 gi√¢y...");
                    setTimeout(() => {
                        location.reload(); 
                    }, 2000);
                }
            } catch (e) {
                console.error(e);
                showToast("L·ªói: M√£ d·ªØ li·ªáu kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng JSON.");
            }
        }

        function clearAllData() {
            if (confirm("C·∫¢NH B√ÅO: B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën X√ìA S·∫†CH to√†n b·ªô d·ªØ li·ªáu c·ªßa Dashboard kh√¥ng? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!")) {
                localStorage.clear();
                document.getElementById('globalDataTextarea').value = "{}";
                showToast("ƒê√£ x√≥a s·∫°ch d·ªØ li·ªáu h·ªá th·ªëng.");
                setTimeout(() => location.reload(), 1500);
            }
        }

        // Toast Notification Function
        function showToast(message) {
            const x = document.getElementById("toast");
            x.textContent = message;
            x.className = "toast show";
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('backupModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>

</body>
</html>