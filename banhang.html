<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhật Ký Bán Hàng - Sales Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel để chạy JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts: Noto Sans -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Noto Sans', sans-serif; }
        
        /* --- TÙY CHỈNH IN ẤN NÂNG CAO --- */
        @media print {
            @page { 
                size: A4 landscape; /* Khổ ngang */
                margin: 5mm;        /* Lề siêu nhỏ */
            }
            
            body { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
                background-color: white !important;
                /* Thu nhỏ trang xuống mức an toàn để vừa hết vào 1 tờ */
                zoom: 67%; 
            }

            /* Ẩn các nút điều khiển khi in */
            .no-print { display: none !important; }

            /* Grid in ấn: Ép cứng 3 cột và giảm khoảng cách */
            .print-grid-fix {
                display: grid !important;
                grid-template-columns: repeat(3, minmax(0, 1fr)) !important; 
                gap: 0.5rem !important; /* Giảm gap từ 1rem xuống 0.5rem */
            }
            
            /* Giảm padding/margin cho các khối khi in */
            .print-compact-p { padding: 0.5rem !important; }
            .print-compact-mb { margin-bottom: 0.5rem !important; }
            .print-no-shadow { box-shadow: none !important; border: 1px solid #ccc !important; }
            
            /* Ép chiều cao textarea nhỏ lại khi in */
            .print-h-auto { min-height: 80px !important; height: auto !important; }

            /* Ngăn ngắt trang */
            .break-inside-avoid { break-inside: avoid; page-break-inside: avoid; }
            
            /* Đảm bảo nội dung không cuộn khi in */
            .no-scroll-on-print { overflow: hidden !important; }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICON COMPONENTS ---
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                Plus: <path d="M5 12h14M12 5v14" />,
                Trash2: <g><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></g>,
                User: <g><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></g>,
                Printer: <g><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></g>,
                RotateCcw: <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12" />,
                MessageSquare: <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />,
                BookOpen: <path d="M2 20h20v-2H2v2zm18-3H4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12zM12 15V7" />
            };

            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        // --- NEW COMPONENT: Interest Group Card (Các nhóm hàng quan tâm) ---
        const InterestGroupCard = ({ interestColumns, setInterestColumns }) => {
            // Chiều cao tối thiểu để đồng bộ với các card sản phẩm khác
            const minHeightClass = "min-h-[220px] md:min-h-[200px] xl:min-h-[200px]"; 

            const handleChange = (column, value) => {
                setInterestColumns(prev => ({ ...prev, [column]: value }));
            };

            return (
                <div className="bg-white rounded-lg shadow-xl overflow-hidden border-2 border-dashed border-blue-300 flex flex-col break-inside-avoid print-no-shadow print:border-blue-500 print:shadow-none">
                    {/* Card Header */}
                    <div className="bg-blue-600 text-white p-2 px-3 flex justify-between items-center print:bg-blue-500 print:text-white print:py-1">
                        <div className="flex items-center gap-2">
                             <Icon name="BookOpen" size={16} />
                            <span className="font-bold text-base">Các nhóm hàng quan tâm</span>
                        </div>
                    </div>

                    {/* Content Area (2 columns, using grid and 2 separate textareas) */}
                    <div className={`p-2 flex-grow grid grid-cols-2 gap-2 ${minHeightClass} no-scroll-on-print`}>
                        
                        {/* Column 1 */}
                        <textarea
                            value={interestColumns.col1}
                            onChange={(e) => handleChange('col1', e.target.value)}
                            placeholder="Cột 1: Mục tiêu, kế hoạch..."
                            className={`w-full h-full p-2 bg-blue-50 rounded-lg border-2 border-blue-100 focus:outline-none focus:border-blue-300 text-slate-700 text-sm resize-none leading-relaxed overflow-hidden print:bg-white print:border-none print:p-0 print:text-xs print-h-auto`}
                        ></textarea>

                        {/* Column 2 */}
                        <textarea
                            value={interestColumns.col2}
                            onChange={(e) => handleChange('col2', e.target.value)}
                            placeholder="Cột 2: Ghi chú, kết quả thực hiện..."
                            className={`w-full h-full p-2 bg-blue-50 rounded-lg border-2 border-blue-100 focus:outline-none focus:border-blue-300 text-slate-700 text-sm resize-none leading-relaxed overflow-hidden print:bg-white print:border-none print:p-0 print:text-xs print-h-auto`}
                        ></textarea>
                    </div>
                    <div className="text-[10px] text-slate-400 p-1 pt-0 text-center">Nội dung không cuộn và được chia thành 2 cột riêng biệt.</div>
                </div>
            );
        };

        // --- DATA SETUP ---

        // 13 nhóm hàng theo yêu cầu
        const predefinedInterestGroups = [
            "Bán hàng Samsung", "Bảo hiểm", "Camera", "FE & TPBank", "Homecredit", "Máy lọc nước", "PHỤ KIỆN - ĐỒNG Hồ", 
            "Sim", "ĐIỆN THOẠI & TABLET ANDROID TRÊN 7 TRIỆU", "Điện thoại Vivo", "Điện tử", "Điện tử & Điện lạnh LG", 
            "ĐẶC QUYỀN NH MÁY GIẶT, SẤY"
        ];
        
        // Chia 13 nhóm thành 2 cột và đánh số thứ tự
        const splitAndFormatGroups = (groups) => {
            const total = groups.length;
            const mid = Math.ceil(total / 2); // 7 nhóm cho cột 1, 6 nhóm cho cột 2
            
            const col1Items = groups.slice(0, mid);
            const col2Items = groups.slice(mid);

            const formatColumn = (items, startNum) => {
                return items.map((item, index) => `${startNum + index}. ${item}`).join('\n');
            };

            const col1Formatted = formatColumn(col1Items, 1);
            const col2Formatted = formatColumn(col2Items, mid + 1); // Bắt đầu từ 8 (7+1)

            return { col1: col1Formatted, col2: col2Formatted };
        };

        const defaultInterestContent = splitAndFormatGroups(predefinedInterestGroups);

        // 8 nhóm hàng cố định cho 8 ô còn lại
        const initialGroups = [
            { id: 1, name: 'Camera', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 2, name: 'Sim', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 3, name: 'ICT / LT', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            // Vị trí thứ 4 (Gia dụng)
            { id: 4, name: 'Gia dụng', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 5, name: 'Bảo hiểm', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 6, name: 'Samsung', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 7, name: 'Phụ kiện', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
            { id: 8, name: 'Điện thoại', monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '', days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' } },
        ];


        // Thông tin chung cũng để trống
        const initialGeneralInfo = {
            userName: '',
            userCode: '',
            week: '',
            mainTarget: '',
            accumulated: '',
            dailyTarget: '',
            categoryTarget: '', 
            dateRange: '',
            signerTitle: 'ĐMX Savico'
        };

        // --- MAIN APP ---
        const SalesDashboard = () => {
            const [generalInfo, setGeneralInfo] = useState(initialGeneralInfo);
            const [managerComment, setManagerComment] = useState('');
            const [groups, setGroups] = useState(initialGroups);
            const [interestContent, setInterestContent] = useState(defaultInterestContent); 

            // Logic tính tổng (xử lý chuỗi rỗng an toàn)
            const calculateWeeklyTotal = (days) => {
                return Object.values(days).reduce((acc, curr) => {
                    const val = parseFloat(curr);
                    return acc + (isNaN(val) ? 0 : val);
                }, 0);
            };

            const handleGroupChange = (id, field, value) => {
                setGroups(groups.map(group => 
                    group.id === id ? { ...group, [field]: value } : group
                ));
            };

            const handleDayChange = (id, day, value) => {
                setGroups(groups.map(group => 
                    group.id === id ? { ...group, days: { ...group.days, [day]: value } } : group
                ));
            };
            
            // Component GroupCard riêng biệt (trích xuất từ JSX chính)
            const GroupCard = ({ group }) => (
                <div key={group.id} className="bg-white rounded-lg shadow-md overflow-hidden border border-slate-100 flex flex-col break-inside-avoid print-no-shadow">
                    {/* Card Header */}
                    <div className="bg-slate-800 text-white p-2 px-3 flex justify-between items-center print:bg-slate-200 print:text-black print:py-1">
                        <input 
                            value={group.name}
                            onChange={(e) => handleGroupChange(group.id, 'name', e.target.value)}
                            className="bg-transparent text-white font-bold text-base focus:outline-none w-3/4 placeholder-slate-400 print:text-black print:placeholder-slate-600"
                            placeholder="Tên nhóm..."
                        />
                        {/* Chỉ cho phép xóa nhóm nếu tổng số nhóm lớn hơn 8 (đã thêm nhóm mới) */}
                        {groups.length > 8 && (
                             <button 
                                onClick={() => removeGroup(group.id)}
                                className="text-slate-400 hover:text-red-400 transition-colors no-print"
                                title="Xóa"
                            >
                                <Icon name="Trash2" size={16} />
                            </button>
                        )}
                    </div>

                    {/* Targets Mini-Grid */}
                    <div className="p-2 bg-slate-50 grid grid-cols-2 gap-2 text-center border-b border-slate-200 print:bg-white print:py-1">
                        <div className="flex flex-col border-r border-slate-200 pr-1">
                            <span className="text-[8px] text-slate-500 uppercase font-bold">Mục tiêu Tháng</span>
                            <input 
                                value={group.monthTarget}
                                onChange={(e) => handleGroupChange(group.id, 'monthTarget', e.target.value)}
                                className="w-full text-center text-xs font-semibold text-slate-700 bg-transparent focus:outline-none"
                                placeholder="..."
                            />
                        </div>
                        <div className="flex flex-col pl-1">
                            <span className="text-[8px] text-slate-500 uppercase font-bold">Lũy kế</span>
                            <input 
                                value={group.accumulated}
                                onChange={(e) => handleGroupChange(group.id, 'accumulated', e.target.value)}
                                className="w-full text-center text-xs font-semibold text-blue-600 bg-transparent focus:outline-none"
                                placeholder="..."
                            />
                        </div>
                        <div className="col-span-2 h-px bg-slate-200 my-0.5"></div>
                        <div className="flex flex-col border-r border-slate-200 pr-1">
                            <span className="text-[8px] text-slate-500 uppercase font-bold">Mục tiêu Tuần</span>
                            <input 
                                value={group.weekTarget}
                                onChange={(e) => handleGroupChange(group.id, 'weekTarget', e.target.value)}
                                className="w-full text-center text-xs font-semibold text-green-600 bg-transparent focus:outline-none"
                                placeholder="..."
                            />
                        </div>
                        <div className="flex flex-col pl-1">
                            <span className="text-[8px] text-slate-500 uppercase font-bold text-purple-600">Mục tiêu Ngày</span>
                            <input 
                                value={group.dailyTarget}
                                onChange={(e) => handleGroupChange(group.id, 'dailyTarget', e.target.value)}
                                className="w-full text-center text-xs font-semibold text-purple-600 bg-transparent focus:outline-none"
                                placeholder="..."
                            />
                        </div>
                    </div>

                    {/* Daily Inputs */}
                    <div className="p-2 flex-grow print:py-1">
                        <div className="grid grid-cols-7 gap-1 mb-1">
                            {['T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'CN'].map(d => (
                                <div key={d} className="text-center text-[9px] font-bold text-slate-400">{d}</div>
                            ))}
                        </div>
                        <div className="grid grid-cols-7 gap-1 mb-2">
                            {Object.keys(group.days).map((day) => (
                                <input
                                    key={day}
                                    type="number"
                                    value={group.days[day]}
                                    onChange={(e) => handleDayChange(group.id, day, e.target.value)}
                                    className="w-full text-center border border-slate-200 rounded py-0.5 text-xs focus:border-blue-500 focus:outline-none"
                                />
                            ))}
                        </div>
                        <div className="flex justify-between items-center pt-2 border-t border-slate-100 print:pt-1">
                            <span className="text-[10px] font-bold text-slate-600 uppercase">Tổng kết tuần:</span>
                            <span className="text-base font-bold text-blue-700">{calculateWeeklyTotal(group.days)}</span>
                        </div>
                    </div>
                </div>
            );


            const addGroup = () => {
                const newId = groups.length > 0 ? Math.max(...groups.map(g => g.id)) + 1 : 1;
                setGroups([...groups, {
                    id: newId,
                    name: 'Nhóm mới',
                    monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '',
                    days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' }
                }]);
            };

            const removeGroup = (id) => {
                // Chỉ cho phép xóa nhóm nếu tổng số nhóm lớn hơn 8 (tức là nhóm được thêm mới)
                if (groups.length > 8 && window.confirm('Bạn có chắc muốn xóa nhóm này?')) {
                    setGroups(groups.filter(g => g.id !== id));
                }
            };

            const clearAllData = () => {
                if (window.confirm('CẢNH BÁO: Bạn muốn xóa TRẮNG toàn bộ thông tin?')) {
                    setGeneralInfo({
                        ...initialGeneralInfo, // Reset về trạng thái rỗng
                        signerTitle: 'DMM Phó/Trưởng'
                    });
                    // Reset groups về 8 nhóm mặc định
                    setGroups(initialGroups.map(g => ({
                        ...g,
                        monthTarget: '', accumulated: '', weekTarget: '', dailyTarget: '',
                        days: { t2: '', t3: '', t4: '', t5: '', t6: '', t7: '', cn: '' }
                    })));
                    setManagerComment('');
                    setInterestContent(defaultInterestContent); // Reset nội dung nhóm hàng quan tâm về mặc định
                }
            };

            const handlePrint = () => {
                window.print();
            };
            
            // Xử lý chèn component InterestGroupCard vào vị trí thứ 5 (index 4)
            // Hiện tại: [0, 1, 2, 3 (Gia dụng), 4 (BH), 5 (SS), 6 (PK), 7 (ĐT)]
            // Chèn vào index 4: [0, 1, 2, 3 (Gia dụng), Interest, 4 (BH), 5 (SS), 6 (PK), 7 (ĐT)] -> SAI, vì ID không trùng với index
            
            // Logic cũ: Chèn vào index 3 (vị trí Gia dụng): [Camera, Sim, ICT/LT, Interest, Gia dụng, Bảo hiểm, Samsung, Phụ kiện, Điện thoại]
            // Vị trí mới: Hoán đổi Interest và Gia dụng. Tức là Interest phải nằm ở index 4.
            const allItems = groups.map(g => ({ type: 'group', data: g }));
            
            // CHỈNH SỬA: Chèn vào index 4 (để nằm sau Gia dụng)
            // Vị trí thứ 4 là Gia dụng (index 3). Vị trí thứ 5 là Bảo hiểm (index 4).
            // Nếu chèn vào index 4, nó sẽ nằm ở vị trí thứ 5, đẩy Gia dụng (index 3) về vị trí thứ 4.
            // Để Gia dụng (ID 4) ở index 3 và Interest ở index 4 (trên lưới 3x3)
            // Cấu trúc hiện tại: [Camera, Sim, ICT/LT, Gia dụng, Bảo hiểm, Samsung, Phụ kiện, Điện thoại]
            // Cấu trúc mong muốn: [Camera, Sim, ICT/LT, Gia dụng, Interest, Bảo hiểm, Samsung, Phụ kiện, Điện thoại] -> KHÔNG PHẢI
            // Cấu trúc mong muốn: [Camera, Sim, ICT/LT, Interest, Gia dụng, Bảo hiểm, Samsung, Phụ kiện, Điện thoại] -> TRUNG TÂM.
            
            // Yêu cầu: Đổi chỗ ô "Các nhóm hàng quan tâm" (hiện ở index 3) và ô "Gia dụng" (nhóm ID 4, hiện ở index 4).
            // Ý của bạn là "Các nhóm hàng quan tâm" phải nằm ở vị trí ô "Gia dụng".
            // Vị trí Gia dụng (ID 4) trên màn hình là: Dòng 2, Cột 1 (index 3)
            // Vị trí của ô "Các nhóm hàng quan tâm" hiện tại: Dòng 2, Cột 1 (index 3)
            
            // Tôi hiểu sai yêu cầu ban đầu. Yêu cầu ban đầu là ô quan tâm nằm ở **trung tâm**, tức là vị trí của ô Gia dụng cũ.
            // Ô Gia dụng cũ là ô thứ 4.
            // Bố cục 3x3:
            // 1, 2, 3
            // 4, 5, 6
            // 7, 8, 9
            //
            // Vị trí trung tâm (ô 5).
            //
            // Ở phiên bản trước, tôi đã chèn ở index 3 (ô thứ 4):
            // 1. Camera
            // 2. Sim
            // 3. ICT/LT
            // 4. Các nhóm hàng quan tâm <--- Vị trí hiện tại (index 3)
            // 5. Gia dụng
            // 6. Bảo hiểm
            // 7. Samsung
            // 8. Phụ kiện
            // 9. Điện thoại
            
            // Nếu bạn muốn "Các nhóm hàng quan tâm" ở vị trí Gia dụng (index 4) và Gia dụng ở vị trí Quan tâm (index 3):
            // Cấu trúc mới:
            // 1. Camera
            // 2. Sim
            // 3. ICT/LT
            // 4. Gia dụng <--- Vị trí mới
            // 5. Các nhóm hàng quan tâm <--- Vị trí mới (TRUNG TÂM)
            // 6. Bảo hiểm
            // 7. Samsung
            // 8. Phụ kiện
            // 9. Điện thoại
            
            // Để làm điều này:
            // 1. Lấy nhóm Gia dụng (ID 4) ra khỏi mảng groups.
            // 2. Chèn Gia dụng vào mảng allItems ở index 3.
            // 3. Chèn InterestCard vào mảng allItems ở index 4.
            
            // Tuy nhiên, logic chèn hiện tại là:
            // const allItems = groups.map(g => ({ type: 'group', data: g }));
            // allItems.splice(3, 0, { type: 'interest', id: 'interest-card' }); 
            
            // Nếu tôi giữ nguyên `groups`: [C, S, I, GD, BH, SS, PK, ĐT] (ID 1-8)
            // `allItems` ban đầu: [C, S, I, GD, BH, SS, PK, ĐT] (8 nhóm)
            // `allItems.splice(3, 0, Interest)` -> Chèn Interest vào vị trí thứ 4.
            // `allItems` sau: [C, S, I, Interest, GD, BH, SS, PK, ĐT]
            
            // Theo yêu cầu của bạn (dựa trên hình ảnh bạn gửi, ô Gia dụng là ô thứ 5, ô Quan tâm là ô thứ 4):
            // Vị trí 1, 2, 3
            // Vị trí 4 (Quan tâm), 5 (Gia dụng), 6 (Bảo hiểm)
            // Vị trí 7, 8, 9
            
            // Yêu cầu mới: "chuyển ô các nhóm hàng quan tâm vào vị trí ô gia dụng, 2 ô đó đổi chỗ cho nhau"
            // Vị trí Gia dụng hiện tại là index 4.
            // Vị trí Quan tâm hiện tại là index 3.
            // Hoán đổi: Quan tâm -> index 4, Gia dụng -> index 3.
            
            // Vị trí chèn mới là index 4.
            const allItemsNew = groups.map(g => ({ type: 'group', data: g }));
            
            // Chèn Interest vào index 4.
            // allItemsNew: [C, S, I, GD, Interest, BH, SS, PK, ĐT]
            // Vị trí trên màn hình:
            // Dòng 1: C, S, I
            // Dòng 2: GD, Interest, BH <--- Interest là ô thứ 5 (Trung tâm)
            // Dòng 3: SS, PK, ĐT
            
            // Điều chỉnh logic chèn:
            const interestCardIndex = 4; // Vị trí 5 (Trung tâm)
            const allItemsFinal = groups.map(g => ({ type: 'group', data: g }));
            allItemsFinal.splice(interestCardIndex, 0, { type: 'interest', id: 'interest-card' }); 
            
            // Bây giờ Gia dụng sẽ nằm ở vị trí thứ 4 (index 3) và Quan tâm nằm ở vị trí thứ 5 (index 4 - Trung tâm).
            
            return (
                <div className="p-4 md:p-6 font-sans text-slate-800 max-w-[1600px] mx-auto print:p-0 print:max-w-none">
                    
                    {/* Control Bar */}
                    <div className="mb-4 flex flex-wrap justify-end gap-3 no-print">
                        <button 
                            onClick={clearAllData}
                            className="flex items-center gap-2 bg-white text-red-500 border border-red-200 px-4 py-2 rounded-lg hover:bg-red-50 transition-colors shadow-sm font-medium text-sm"
                        >
                            <Icon name="RotateCcw" size={16} />
                            Xóa trắng dữ liệu
                        </button>
                        <button 
                            onClick={handlePrint}
                            className="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm"
                        >
                            <Icon name="Printer" size={16} />
                            In / Xuất PDF
                        </button>
                    </div>

                    {/* HEADER INFO BLOCK */}
                    <div className="bg-white rounded-xl shadow-md p-4 mb-4 border-t-4 border-blue-600 break-inside-avoid print:mb-2 print:p-2 print-compact-mb print-no-shadow print:border">
                        <div className="flex flex-col md:flex-row justify-between items-center gap-4 mb-4 print:mb-2 print:gap-2">
                            <div className="flex items-center gap-3 w-full md:w-auto">
                                <div className="bg-blue-100 p-3 rounded-full no-print">
                                    <Icon name="User" className="text-blue-600" size={24} />
                                </div>
                                <div className="text-left w-full">
                                    <label className="block text-[10px] text-slate-500 uppercase font-bold tracking-wider">Nhân viên</label>
                                    <input 
                                        type="text" 
                                        value={generalInfo.userName} 
                                        onChange={(e) => setGeneralInfo({...generalInfo, userName: e.target.value})}
                                        className="text-lg font-bold text-slate-800 border-b border-dashed border-slate-300 focus:outline-none focus:border-blue-500 bg-transparent w-full placeholder-slate-300"
                                        placeholder="Nhập tên..."
                                    />
                                </div>
                            </div>
                            
                            <div className="flex gap-4 w-full md:w-auto justify-between md:justify-end">
                                <div>
                                    <label className="block text-[10px] text-slate-500 uppercase font-bold">Mã NV</label>
                                    <input 
                                        value={generalInfo.userCode}
                                        onChange={(e) => setGeneralInfo({...generalInfo, userCode: e.target.value})}
                                        className="font-semibold w-24 border-b border-dashed border-slate-300 focus:outline-none text-center bg-transparent"
                                        placeholder="..."
                                    />
                                </div>
                                <div>
                                    <label className="block text-[10px] text-slate-500 uppercase font-bold">Tuần</label>
                                    <input 
                                        value={generalInfo.week}
                                        onChange={(e) => setGeneralInfo({...generalInfo, week: e.target.value})}
                                        className="font-semibold w-16 border-b border-dashed border-slate-300 focus:outline-none text-center bg-transparent"
                                        placeholder="..."
                                    />
                                </div>
                            </div>
                        </div>

                        {/* KPIS */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-3 bg-slate-50 rounded-lg p-3 border border-slate-200 print:bg-white print:border-none print:p-0 print:gap-2">
                            {[
                                { label: 'Target (Mục tiêu)', val: generalInfo.mainTarget, setVal: v => setGeneralInfo({...generalInfo, mainTarget: v}), color: 'text-green-600', border: 'border-green-500' },
                                { label: 'Lũy kế hiện tại', val: generalInfo.accumulated, setVal: v => setGeneralInfo({...generalInfo, accumulated: v}), color: 'text-yellow-600', border: 'border-yellow-500' },
                                { label: 'Mục tiêu ngày', val: generalInfo.dailyTarget, setVal: v => setGeneralInfo({...generalInfo, dailyTarget: v}), color: 'text-purple-600', border: 'border-purple-500' },
                                { label: 'Mục tiêu NH đạt', val: generalInfo.categoryTarget, setVal: v => setGeneralInfo({...generalInfo, categoryTarget: v}), color: 'text-blue-600', border: 'border-blue-500' },
                            ].map((kpi, idx) => (
                                <div key={idx} className={`flex flex-col items-center justify-center p-2 bg-white rounded shadow-sm border-l-4 ${kpi.border} print:border print:shadow-none`}>
                                    <span className="text-slate-500 text-[10px] font-bold uppercase mb-1">{kpi.label}</span>
                                    <input 
                                        value={kpi.val}
                                        onChange={(e) => kpi.setVal(e.target.value)}
                                        className={`text-lg font-bold ${kpi.color} text-center w-full focus:outline-none bg-transparent`}
                                        placeholder="0"
                                    />
                                </div>
                            ))}
                        </div>
                        
                        <div className="mt-3 text-center print:mt-1">
                            <label className="text-[10px] text-slate-400 uppercase mr-2 font-bold">Thời gian:</label>
                            <input 
                                value={generalInfo.dateRange}
                                onChange={(e) => setGeneralInfo({...generalInfo, dateRange: e.target.value})}
                                className="text-center font-medium text-slate-600 focus:outline-none border-b border-transparent hover:border-slate-300 w-32 bg-transparent"
                                placeholder="dd/mm - dd/mm"
                            />
                        </div>
                    </div>

                    {/* PRODUCTS GRID */}
                    <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 mb-4 print-grid-fix print:mb-2 print:gap-2">
                        {/* Render items based on the new order */}
                        {allItemsFinal.map((item, index) => {
                            if (item.type === 'group') {
                                return <GroupCard key={item.data.id} group={item.data} />;
                            } else if (item.type === 'interest') {
                                return (
                                    <InterestGroupCard 
                                        key={item.id} 
                                        interestColumns={interestContent}
                                        setInterestColumns={setInterestContent}
                                    />
                                );
                            }
                            return null;
                        })}

                        {/* Add Button (Chỉ hiển thị khi tổng số ô < 9) */}
                        {groups.length < 8 && (
                            <button 
                                onClick={addGroup}
                                className="flex flex-col items-center justify-center min-h-[180px] bg-slate-50 border-2 border-dashed border-slate-300 rounded-lg hover:bg-white hover:border-blue-400 transition-all group cursor-pointer no-print"
                            >
                                <div className="bg-white p-2 rounded-full shadow-sm group-hover:shadow-md mb-2 transition-all">
                                    <Icon name="Plus" className="text-slate-400 group-hover:text-blue-500" size={20} />
                                </div>
                                <span className="text-slate-400 font-medium group-hover:text-blue-500 text-xs">Thêm ngành hàng</span>
                            </button>
                        )}

                        {/* Ô trống nếu có đủ 9 ô (8 nhóm + 1 quan tâm) nhưng nhóm không đủ 9 */}
                        {/* Hiện tại luôn có 9 ô (8 nhóm + 1 quan tâm) nên không cần ô trống */}
                        {groups.length >= 8 && allItems.length === 9 && (
                            <div className="hidden"></div>
                        )}

                    </div>

                    {/* MANAGER COMMENTS */}
                    <div className="bg-white rounded-xl shadow-md border-l-8 border-orange-500 overflow-hidden break-inside-avoid print-no-shadow print:border print:border-orange-500">
                        <div className="p-4 print:p-2">
                            <div className="flex items-center gap-2 mb-2 print:mb-1">
                                <Icon name="MessageSquare" className="text-orange-500" size={20} />
                                <h3 className="text-base font-bold text-slate-800 uppercase">Nhận xét của Quản lý</h3>
                            </div>
                            <div className="relative">
                                <textarea
                                    value={managerComment}
                                    onChange={(e) => setManagerComment(e.target.value)}
                                    placeholder="Nhập nội dung đánh giá..."
                                    className="w-full min-h-[100px] p-3 bg-orange-50 rounded-lg border border-orange-100 focus:outline-none focus:border-orange-300 text-slate-700 text-sm resize-y leading-relaxed print-h-auto print:bg-white print:border-none print:p-0"
                                ></textarea>
                            </div>
                            <div className="mt-4 flex justify-end gap-3 print:mt-2">
                                <div className="text-right flex flex-col items-end">
                                    <input 
                                        value={generalInfo.signerTitle}
                                        onChange={(e) => setGeneralInfo({...generalInfo, signerTitle: e.target.value})}
                                        className="text-xs font-bold text-slate-700 text-right border-b border-transparent hover:border-slate-300 focus:outline-none bg-transparent w-40 mb-1"
                                    />
                                    <div className="h-12 w-24 border-b border-dashed border-slate-300 mb-1 print:h-8"></div>
                                    <div className="text-[10px] text-slate-400">Ký tên</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SalesDashboard />);
    </script>
</body>
</html>